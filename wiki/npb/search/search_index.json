{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Introduction","text":"<p>This user guide provides instructions on how to design, build and run  the network protocols bridges (NPB) and its digital twin (DT).  Two use cases 01 &amp; 02 demonstrates simulated applications of the NPB. </p> <p> Note: This document is intended to use on Linux  machines.  </p>"},{"location":"#table-of-contents","title":"Table of Contents","text":"<ol> <li> <p>Development Environment Setup </p> <p>Instructions on settings up Papyrus4Manufacturing. </p> </li> <li> <p>AAS Model design </p> <p>Instructions on designing an AAS model for NPB and NPB DT.    </p> </li> <li> <p>Software NPB generation </p> <p>Instructions on generating and configuring NPB.    </p> </li> <li> <p>NPB Digital Twin generation </p> <p>Instructions on generating and configuring AAS DT of NPB.   </p> </li> <li> <p>Use case 01: Product Assembly Line </p> <p>Production Assembly Line use case description and deployment steps.    </p> </li> <li> <p>Use case 02: Led Waterfall </p> <p>Led Waterfall use case description and deployment steps.   </p> </li> </ol>"},{"location":"#acknowledgements","title":"Acknowledgements","text":"<p>This document and its related resources are developed within the project  TARGET-X : ROS6GBridge. The TARGET-X project  has received funding from the  Smart Networks and Services Joint Undertaking (SNS JU) under the  European Union's Horizon Europe research and innovation program under  Grant Agreement No 101096614. </p>"},{"location":"design/","title":"AAS Model Design","text":"<p>Asset Administration Shell (AAS) is an industrial standard developed by  IDTA. The AAS model is likely the UML Class diagram with the concepts from the AAS standard.  This section focus on using Papyrus4Manufacturing to design an AAS model to  generate NPB and NPB DT.   </p>"},{"location":"design/#step-by-step-guide","title":"Step-by-Step Guide","text":"<p>This section presents three basic steps to design an AAS Model  for NPB and NPB DT. You can find the detail description about how to design an AAS model using the cheet sheets of Papyrus4Manufacturing.  </p>"},{"location":"design/#step-1-create-papyrus-project","title":"Step 1: Create Papyrus Project","text":"<p>Open Papyrus4Manufacturing. In the menu bar,  go to File &gt; New &gt; Project... &gt; Papyrus &gt; Papyrus Project,  then click Next. In the new appeared window,  check AAS Modeling Language, then click Next.  Input the required information, including the Project name and location,  then click Finish.  In the Project Explorer window, a new folder is generated with related  files di, notation, and uml. </p>               Figure 1. Project is created and shown in the Project Explorer window"},{"location":"design/#step-2-design-an-aas-model-for-npb","title":"Step 2: Design an AAS model for NPB","text":"<p>In the Project Explorer window, double click on the Papyrus icon under the  new created folder. Next, it is necessary to create an asset (means NPB),  its AAS (means NPB DT), and its two AAS submodels Interfaces  and Routing.   </p>"},{"location":"design/#a-design-asset-npb","title":"A. Design Asset (NPB)","text":"<p>In the Model Explorer window, the model folder appears. Right click at the  folder, go to New Package child &gt; Asset.  In the Properties window, you need to input the information of the asset.  The following fields are fundamental: - Asset: the name of the asset. Choose a name, such as BrxFPGA - Kind: the type of the model element. Choose Instance.  - Identification: the identifier of the asset. Click the plus button,  choose idType as Custom, then input an id. - Endpoint: the endpoint that the NPB expose to its NPB DT to connect.  Click the plus button, input the information about the address  and name of the endpoint.  </p> <p> Note: The current version of NPB only supports the  WebSocket endpoint.  </p>                                            Figure 2. Endpoint and Identifcation fields of the asset BrxFPGA"},{"location":"design/#b-design-aas-npb-dt","title":"B. Design AAS (NPB DT)","text":"<p>In the Model Explorer window. Right click at Asset,  go to New Asset child &gt; AAS. In the Properties window, you need  to input the information of the AAS.  In the Properties window, you need to input the information of the AAS.  The following fields are fundamental: - Name: the name of the AAS. Choose a name, such as BrxFPGA.  - Identification: the identifier of the AAS. Click the plus button,  choose idType as Custom, then input an id. - Endpoint: the endpoint that the NPB DT expose to external application.  Click the plus button, input the information about the address  and name of the endpoint.  </p> <p> Note: The name of asset and its AAS DT can be the same and  should have at least three letters.  </p>"},{"location":"design/#c-design-interfaces-and-routing-submodels","title":"C. Design Interfaces and Routing submodels","text":"<p>The two submodels Interfaces and Routing are fundamental and required  by the NPB. You can add other submodels to the AAS model.  </p> <p>In the Model Explorer window. Right click at AAS,  go to New AAS child &gt; Submodel to create one submodel.  Repeat the step to create the second one.  In the Properties window, you need to input the information required by each submodel.  The following fields are fundamental: - Name: the name of the submodel. Input Interfaces for the  first submodel, and Routing for the second submodel.  - Kind: the type of the submodel. Choose Instance.  - Identification: the identifier of the AAS. Click the plus button,  choose idType as Custom, then input an id.  </p> <p> Note: The submodel must be Interfaces and  Routing.  If written incorrectly, it will not function properly. </p> <p>In the Interfaces submodel, add properties related to the network interfaces that your NPB supports. Right click at Interfaces,  go to New Submodel child &gt; Property. Likewise, in the Routing submodel, add properties related to  the routing nodes that your NPB supports. You must use the Properties window to specify each property.  The following fields are fundamental for a property: - Name: the name of the property.  - Is dynamic: the value of the property is changable or not. Choose true.  - Endpoint: the endpoint related to the property. Choose the endpoint of the asset.  - Kind: the type of the submodel. Choose Instance.  - Type: the data type of the value of the property. Choose Boolean.    </p>                                            Figure 3. Submodels Interfaces and Routing with their properties      <ul> Note: <li> The property of Interfaces can be ros2,  modbustcp, ethernetip,  uafx, or canopen.  If written incorrectly, it will not function properly </li> <li> The property of Routing must follow the format  brx_[A]_[B]_[C]. In which, A is device id, B is group id, and C is node id.  If using the wrong format, it will not function properly </li> </ul>"},{"location":"design/#step-3-activate-the-npb-generation-feature","title":"Step 3: Activate the NPB generation feature","text":"<p>In the Project Explorer window, right click on di file,  go to Open With &gt; Text Editor.  In the appeared editor window, add <code>featureId=\"ceatmp1015750572\"</code> right before <code>/&gt;</code> in the second line. </p>                                            Figure 4. Information about featureId in di file"},{"location":"design/#helpful-tips","title":"Helpful Tips","text":"<p>This section presents some useful tips to design AAS model for NPB and NPB DT. </p>"},{"location":"design/#aas-model-validation","title":"AAS Model Validation","text":"<p>The validation tool is intergrated into Papyrus4Manufacturing.  In the Model Explorer window, right click at the model element needed to be valided, go to Validation &gt; Validation Model.  The result of the validation will be shown on the Model Validation window.  </p>                                            Figure 5. Validation window details the error of an AAS model design"},{"location":"design/#viewing-model-design-with-the-class-diagram-designer","title":"Viewing model design with the Class Diagram Designer","text":"<p>An AAS model design can be viewed with the Class diagram. In the Model Explorer window. Right click at the folder Assets,  go to New Diagram &gt; AAS Design Diagram.  Double click on the diagram to open diagram editor.  You can drag-and-drop the element from the Model Explorer window into this  editor. Use the pallette to add other elements if necessary. </p>                                            Figure 6. AAS model viewed as a Class diagram"},{"location":"genaas/","title":"Network Protocols Bridge Digital Twin Generation","text":"<p>Network Protocols Bridge (NPB) Digital Twin (DT) is a software component  working as a Software-Defined Networking controller that can monitor and  configure the NPB at runtime. Technically, a NPB DT is an AAS DT of the NPB.  The generation of NPB DT from the AAS model is integrated into the  Papyrus4Manufacturing. </p>"},{"location":"genaas/#step-by-step-guide","title":"Step-by-Step Guide","text":"<p>This section presents three basic steps to generate NPB DT.</p>"},{"location":"genaas/#step-1-generate-aas-dt-java-maven-project","title":"Step 1: Generate AAS DT Java Maven project","text":"<p>In the Model Explorer window, right click at the AAS,  go to AAS &gt; Generate Asset Administration Shell BaSyx Code (AAS).  If the AAS model design is correct, then a new generate code folder will  appear in the Project Explorer window and it will show no error  (no red star on the project icon). </p> <p>If there is no new generated folder or a new project is generated with  a red star, you should recheck the AAS model design and re-generate it. </p>               Figure 1. Successful new generated Java Maven project for AAS DT       <p> Note: The files generated can be different depended on the  featureId.   </p>"},{"location":"genaas/#step-3-modifying-java-codes","title":"Step 3: Modifying Java Codes","text":"<p>In general, the generated Java code is ready to use,  but you can modify the generated Java codes for further customization.  This step requires basic knowledge on Java programming. </p> <p>In the Model Explorer window, browse the folder src/main/java.  This folder includes all of the Java source code related to the AAS DT.  </p> <p> Note: Your new added codes can be overried when you re-generate  the AAS project. So you should be careful.  </p>"},{"location":"genaas/#usage","title":"Usage","text":"<p>You can run the NPB DT on the Papyrus4Manufacturing environment:  In the Project Explorer, right click at  the AASServer.launch file,  go to Run As &gt; AASServer.</p> <p>If the NPB DT boots correctly, it will connect to the NPB and expose a AAS standard HTTP interface to external applications.  The interface listens to the endpoint defined in the design. </p>         Figure 2. HTTP external interface of a sucessful run NPB DT      <p> Note: The NPB must be running before launching the NPB DT.  If not, an error will occur.  </p> <p>There are two methods to interact with the NPB DT.  First is to use the HTTP REST API as other AAS DTs  generated by Papyrus4Manufacturing. To check the API, you can open the README.md file generated  in the generated project. </p> <p>The second method is to use the Graphic User Interface (GUI) integrated into the NPB DT. Open a web browser, and enter the NPB DT endpoint with the path <code>/p4m/gui</code>. This GUI has a monitoring board that observes properties and operations of the NPB DT.  A command chat box allowing users to input the command to  interact with the NPB DT.  Some valid commands are log, read, write, call, and reload.  </p>            Figure 3. Runing the command \"log\" on the GUI of NPB DT"},{"location":"genaas/#helpful-tips","title":"Helpful Tips","text":"<p>This section presents some useful tips to build and run NPB DT.</p>"},{"location":"genaas/#backup-code","title":"Backup code","text":"<p>Remember to backup your code to a new folder before re-generating the  project. A simple method is to copy and paste the the project in  Project Explorer. For the step: right click at the project folder,  press Ctrl + C, then press Ctrl + V. In the new appeared window,  change the name of new project then click Copy. </p> <p>Another way to backup code is to use git. Open your terminal and  navigate to your project. Using the following commands.  </p> <p>$ <code>git init</code> $ <code>git add .</code> $ <code>git commit -m \"SOME IMPORTANT MESSAGE\"</code> </p>"},{"location":"genaas/#interact-with-npb-dts-http-interface-using-postman","title":"Interact with NPB DT's HTTP interface using Postman","text":"<p>Postman is a good tool to create HTTP REST commands and interact with  the HTTP interface of the NPB DT.  To install and run the standalone version:  </p> <p>$ <code>wget https://dl.pstmn.io/download/latest/linux_64</code> $ <code>tar -xvzf postman-linux-x64.tar.gz</code> $ <code>./Postman/Postman</code> </p> <p>For more information, check the Postman's  tutorial.</p>"},{"location":"gennpb/","title":"Software Network Protocols Bridge Generation","text":"<p>Network Protocols Bridge (NPB) is a software component that can bridge  different industrial network protocols,  including Modbus TCP, OPC UA PubSub, EtherNet/IP Class 1,  ROS 2, and CANopen.  The generation of this software component from the AAS model is integrated  into the Papyrus4Manufacturing. </p>"},{"location":"gennpb/#step-by-step-guide","title":"Step-by-Step Guide","text":"<p>This section presents three basic steps to generate software NPB.</p>"},{"location":"gennpb/#step-1-generate-npb-java-maven-project","title":"Step 1: Generate NPB Java Maven project","text":"<p>In the Model Explorer window, right click at the AAS,  go to AAS &gt; Generate Network Protocols Bridge (NPB).  If the AAS model design is correct, then a new generate code folder will  appear in the Project Explorer window and it will show no error  (no red star on the project icon). </p> <p>If there is no new generated folder or a new project is generated with  a red star, you should recheck the AAS model design and re-generate it. </p>            Figure 1. Successful new generated Java Maven project for NPB       <p> Note: The files generated can be different depended on the  featureId.   </p>"},{"location":"gennpb/#step-2-build-the-npb-software","title":"Step 2: Build the NPB software","text":"<p>Two methods to build the NPB software.  First, in the Project Explorer window, right click at the pom.xml file,  go Maven &gt; Update Project....  In the new appeared window, check Force Update of Snapshots/Releases,  click OK.  Right click at the pom.xml again, go to Run As &gt; Maven Install. </p> <p>In the second, open a terminal. Run the following commands: </p> <p>$ <code>cd &lt;YOUR_PROJECT_WORKSPACE&gt;</code> $ <code>mvn clean install -U</code></p>          Figure 2. Successful build with the second method"},{"location":"gennpb/#usage","title":"Usage","text":"<p>You can run the NPB on the Papyrus4Manufacturing environment:  In the Project Explorer, right click at the project folder of the NPB,  go to Run As &gt; Java Application.</p> <p> Note: If an error related to root privileges occur due to the need of root access for some ports (e.g. default port 502 for Modbus TCP),  re-run Papyrus4Manufacturing with sudo.  </p> <p>Another method is to use Docker.  Search for the docker images generated by the build then run it with  adequate parameters.  We supports also a run.sh including the command the Docker with  pre-defined parameters in the generated NPB folder. </p> <p>If the NPB boots correctly, the console will show no error  and all network interfaces are raised properly. </p>         Figure 3. Successful run NPB"},{"location":"gennpb/#helpful-tips","title":"Helpful Tips","text":"<p>This section presents some useful tips to build and run NPB.</p>"},{"location":"gennpb/#devices-configuration","title":"Devices configuration","text":"<p>The EtherNet/IP device must work in adapter mode and be turned on before  connecting to the NPB.  In other words, the EtherNet/IP device needs to boot first,  then you can launch the NPB. You should get the parameters in the EDS associated to  the EtherNet/IP device to configure the application.properties  file of NPB.  This configuration requires knowledge on the EtherNet/IP.</p> <p>To test CANopen device, you can use a virtual can (vcan) interface and using a tunnel to translate CAN-Socket data messages. </p>"},{"location":"gennpb/#network-configuration","title":"Network configuration","text":"<p>To check the available network interfaces in your computer, you can use one  of following commands: </p> <p>$ <code>ifconfig</code> $ <code>ip address</code> </p> <p>To raise network interface vcan0 required by CANopen, you use the following  commands: </p> <p>$ <code>sudo modprobe vcan</code> $ <code>sudo ip link add dev vcan0 type vcan</code> $ <code>sudo ip link set vcan0 mtu 16</code> $ <code>sudo ip link set up vcan0</code> </p> <p>Some default values of network interfaces' configuration: - The default port of ModbusTCP is 502.  - The default port of OPC UA PubSub is 4801.  - The default port of EtherNet/IP is 2222 and 44818.  - The default ROS DOMAIN ID of ROS2 is 0.    </p>"},{"location":"setup/","title":"Environment Setup","text":"<p>Papyrus4Manufacturing provides an Intergrated Development Environment (IDE) to design and develop NPB and AAS DT of the NPB.  The following steps guide you to download and run the IDE on your computer. </p>"},{"location":"setup/#step-by-step-guide","title":"Step-by-Step Guide","text":"<p>Two basic steps to download and setup Papyrus4Manufacturing IDE. </p>"},{"location":"setup/#step-1-download-papyrus4manufacturing","title":"Step 1: Download Papyrus4Manufacturing","text":"<p>Open your web browser and navigate to the official  Papyrus4Manufacturing website. In the navigate bar of the website, go to  Downloads AAS Designer &gt; Nightly RCP section.  Click to download and save the file to the workspace in your computer. </p>                                            Figure 1. Download the Nightly RCP Papyrus4Manufacturing version"},{"location":"setup/#step-2-run-papyrus4manufacturing","title":"Step 2: Run Papyrus4Manufacturing","text":"<p>Extract the downloaded file (p4m_nightly_linux.tar.gz).  You can use the following command: </p> <p>$ <code>tar -xvzf p4m_nightly_linux.tar.gz</code></p> <p>After the extraction, you will have a new folder Papyrus4AAS.  Inside this folder, there are resources to run the Papyrus4Manufacturing IDE. Launch it with the following command:  </p> <p>$ <code>./Papyrus4AAS/Papyrus4Manufacturing</code></p> <p>For the first launch, you must choose a workspace to save your future Papyrus4Manufacturing projects. Browse you target folder,  check the box Use this as the default and do not ask again,  then click Launch.  You should walkthrough the cheet sheets in the Cheet Sheets window to  understand the basic steps to design AAS and deploy AAS DT. </p>                                            Figure 2. Cheet Sheets window in the GUI of Papyrus4Manufacturing"},{"location":"setup/#helpful-tips","title":"Helpful Tips","text":"<p>Some tools are helpful for the development. </p>"},{"location":"setup/#install-tm-terminal-on-papyrus4manufacturing","title":"Install TM Terminal on Papyrus4Manufacturing","text":"<p>Open Papyrus4Manufacturing. In the menu bar,  go to Help &gt; Install New Software. In the Work with field, input  the URL <code>https://download.eclipse.org/tools/cdt/releases/11.6/</code>, click Add. Wait for the list to populate. Check the box Terminal Features and Terminal SDK Features, click Next, then continue with  the on-screen instructions. After the installation is finished, you need to  restart Papyrus4Manufacturing. </p> <p>To open the TM Terminal: in the menu bar,  go to Window &gt; Show View &gt; Other... &gt; Terminal.  The terminal tray will appear. Using the shortcut key Ctrl + Shift + Alt + T to  open a new terminal. </p>                                            Figure 3. TM Terminal on Papyrus4Manufacturing"},{"location":"setup/#install-docker-on-linux","title":"Install Docker on Linux","text":"<p>Open a terminal. Install the docker version for linux using apt:   </p> <p>$ <code>sudo apt install docker.io</code> </p> <p> Note: The version docker-ce can be used instead. </p> <p>Check if docker is succesfully installed with the following command.  The expected result is the header row of an empty table with no  running docker containers.  </p> <p>$ <code>docker ps</code> </p> <p>Enable your user account to use Docker without needing root privileges:   </p> <p>$ <code>sudo groupadd docker</code>  $ <code>sudo usermod -aG docker $USER</code></p>"},{"location":"uc01/","title":"Use Case 01: Product Assembly Line","text":"<p>Content will be available soon. Stay tuned!</p>"},{"location":"uc02/","title":"Use Case 02: Led Waterfall","text":"<p>Content will be available soon. Stay tuned!</p>"}]}